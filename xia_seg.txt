get_seg_catchup_info.sql
★修正箇所
CatchUpInfo同様にCHANGE_TYPEの取り扱いが間違っている。
PERSON_BIOMETRICS.BIOMETRIC_DATA,PERSON_BIOMETRICS.EVENT_IDとBISON+ではないカラムを指定している。
WHERE scl.BIOMETRICS_ID = pb.BIOMETRICS_IDとなっているがAIM5ではLEFT JOINとしているので意味合いが変わってる。
    IF (p_component_type = 3) THEN
        INSERT INTO catchup_info_tab(segmentId,biometrocsId,segVer,changType,bioData,extId, eventId)
      SELECT
        scl.SEGMENT_ID,
        scl.BIOMETRICS_ID,
        scl.SEGMENT_VERSION,
        scl.CHANGE_TYPE,
        CASE WHEN scl.CHANGE_TYPE = 1 THEN NULL ELSE pb.BIOMETRIC_DATA END AS BIOMETRIC_DATA,
        pb.EXTERNAL_ID,
        pb.EVENT_ID
      FROM SEGMENT_CHANGE_LOG scl,PERSON_BIOMETRICS pb
      WHERE scl.BIOMETRICS_ID = pb.BIOMETRICS_ID 
      AND scl.SEGMENT_CHANGE_ID IN (SELECT id FROM  history_ids) 
      ORDER BY scl.SEGMENT_ID, scl.SEGMENT_CHANGE_ID; 


◆CatchUpInfo.java
★修正箇所
CHANGE_TYPE:0はBISON+ではNewSegment、INSERTはCHANGE_TYPE:1となっているので以下の条件式の修正が必要
    public SegmentSyncCommandType getCommand() {
        return (command == 0) ? SEGMENT_SYNC_COMMAND_INSERT
                : SEGMENT_SYNC_COMMAND_DELETE;
    }

★修正例
    public SegmentSyncCommandType getCommand() {
        return (command == 1) ? SEGMENT_SYNC_COMMAND_INSERT
                : SEGMENT_SYNC_COMMAND_DELETE;
    }