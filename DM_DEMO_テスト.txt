そもそもテスト仕様は設計仕様との違いがあります：


PPT 44ページ：
Add segment」は、DM-ServiceがDM-Nodeを選定、それぞれのDM-Nodeに通知。
正常を応答したNode自身はDBを更新しない。
 DM-ServiceがSegment-Info, Segment-Node（正常NodeはVer=-1、通知不達Node、Ver=-9）を更新。
通知不達の場合、そのNodeの “Semaphore flag = signal”状態に設定する。つまり、Node自ら行動を起こすことを促す。

※：NewSegment時、通知不達Node、Ver=-9に更新、“Semaphore flag = signalに更新

Add/Del Template」は、DM-Serviceが該当のSegmentの上がるVersionを計算（以下はVer-A）、
そのSegmentを持つDM-Nodeを選び、そのNodeが持っているSegmentのVersionも確認（以下はVer-B）。
Ver-A＝Ver-B+1のNodeに通知する（Addの場合、Templateも電文に含む）。
Version情報が遅れたNodeに通知しないが、そのNodeの “Semaphore flag = signal”状態に設定する。
通知の結果と関係なくSegment情報は更新するが、
正常と応答したNodeのみ、Segment-NodeのVersionを更新。正常と応答したNode自身はDBの更新はしない

※：Add/Del Template」の時、Version情報が遅れたNodeに通知しないが、そのNodeの “Semaphore flag = signal”状態に設定する。
　　通知不達の場合、“Semaphore flag = signal”との記述はありません、

テストの仕様は、TemplateInsertで、nodo storage managerのVersion情報が遅れることはですが、
nodo storage managerをOfflineにして、web serviceに“Semaphore flag = signal”に設定してほしいとのテスト仕様でした。
DM serivce は上記の仕様より、Add/Del Template」の時、通知不達の場合、“Semaphore flag = signal”との記述はないので、
Semaphore flag = signalに設定していません。
DM serivce のミスとして、素直にその場で、ソースを修正しましたが、
結果は上記の報告になりました。








